# 영속성 컨텍스트(Persistence Context)와 쓰기 지연(Write Behind)

데이터베이스와 애플리케이션 사이의 상호작용을 관리하는 데 사용되는 중요한 개념들입니다.

## 1. 영속성 컨텍스트(Persistence Context)

영속성 컨텍스트는 객체 지향 프로그래밍 언어에서 객체와 데이터베이스 간의 매핑과 상호작용을 관리하는 데 사용되는 메모리 영역입니다. 대표적으로 Java에서는 Java Persistence API(JPA) 또는 Hibernate와 같은 영속성 프레임워크를 사용하여 영속성 컨텍스트를 구현합니다.

영속성 컨텍스트는 엔티티(Entity) 객체들의 생명 주기를 추적하고, 데이터베이스와의 효율적인 상호작용을 담당합니다. 즉, 영속성 컨텍스트는 애플리케이션과 데이터베이스 사이에서 데이터를 관리하는 중간 계층으로 작동합니다.

### **영속성 컨텍스트의 주요 기능**

- 엔티티의 영속성 관리: 영속성 컨텍스트는 데이터베이스에서 조회된 엔티티 객체들을 관리하고, 변경사항을 감지하여 적절한 시점에 데이터베이스에 동기화합니다.
- 1차 캐시: 영속성 컨텍스트는 엔티티 객체를 캐싱하여, 동일한 엔티티를 반복적으로 조회할 때 데이터베이스에 접근하지 않고 캐시된 객체를 사용합니다. 이는 조회 성능을 향상시킵니다.
- 트랜잭션 관리: 영속성 컨텍스트는 트랜잭션 범위 내에서 엔티티 변경을 추적하고, 트랜잭션이 커밋될 때 변경사항을 데이터베이스에 반영합니다.

단점:

## 2. 쓰기 지연(Write Behind)

쓰기 지연은 데이터베이스에 대한 변경 작업(INSERT, UPDATE, DELETE)을 가능한 한 늦추는 최적화 기법 중 하나입니다. 쓰기 지연은 변경 작업을 모아서 일괄적으로 실행함으로써 데이터베이스 트랜잭션의 수를 줄이고, 데이터베이스의 부하를 감소시키는 데 도움이 됩니다.
예를 들어, 영속성 컨텍스트에서 엔티티의 상태가 변경되더라도 바로 데이터베이스에 쿼리를 보내지 않고 변경 내용을 쓰기 지연 큐에 저장합니다. 쓰기 지연 큐에 모인 변경 작업들은 일정 기준(일정 시간 경과 또는 일정 갯수의 작업 등)을 충족하면 한 번에 데이터베이스에 반영됩니다. 이를 통해 데이터베이스와의 효율적인 통신을 이뤄낼 수 있습니다.

영속성 컨텍스트와 쓰기 지연은 종종 함께 사용되며, 트랜잭션이 커밋되는 시점에 영속성 컨텍스트의 변경사항들이 쓰기 지연 큐에 모아진 후 일괄적으로 데이터베이스에 반영됩니다. 이를 통해 불필요한 쿼리 호출을 최소화하고, 데이터베이스의 부하를 감소시키면서 성능을 향상시킬 수 있습니다.
